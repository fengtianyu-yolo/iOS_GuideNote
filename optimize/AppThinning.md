# 包大小优化

## 图片资源处理

### 删图片资源

#### 1. 删除未使用的图片资源

查找未使用的图片

1. 获取所有的图片名，放到一个集合中

2. 遍历每一个文件，检查文件中是否出现该图片的名，如果出现该图片名，则从集合中移除。

	1. 如果出现 `imageNamed:@""` 字符串，则表示该图片有使用

	2. 如果出现 `@""`，表示该图片可能是被使用，需要再检查

	3. 需要特殊注意带有规则的图片名 ， 如@`"img_%d"` 这种的

#### 2. 删重复的图片

比较图片的MD5，如果MD5是相同的则是相同图片。

#### 3. 删相似的图片

做图片的相似度比较，图片相似度高的，可以选择删除

### 工具

* LSUnusedResources

## 文件资源

### 删除没有使用的类文件

#### 如何查找没有使用的类文件

##### 方式一：逆向可执行文件

1. 通过otool逆向`__DATA._objc_classlist` 可以拿到所有的类列表

2. otool 逆向 `__DATA._objc_classrefs` 可以拿到使用的类的列表

3. 两个集合的差集就是未使用的类

##### 方式二：正则匹配去比较

1. 拿到所有的类文件的文件名

2. 去遍历每个文件，通过匹配特定字符串，如`[xx alloc]`、`[xx new]` 等字符串去筛选

##### 方式三：AppCode的Inspect Code 功能

### 删除没有使用的方法

## 图片格式角度

## 针对特定文件去优化

通过LinkMap统计占用空间较大的文件，去单独优化处理


